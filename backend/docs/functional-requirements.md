# 占卜应用管理后台功能需求文档

## 1. 功能模块概览

### 1.1 核心管理模块
- **AI模型配置管理** - 管理AI服务提供商、模型参数
- **提示词模板管理** - 管理系统提示词和解读模板
- **应用配置管理** - 管理应用设置和功能开关
- **内容数据管理** - 管理卦象数据和多语言内容
- **平台配置管理** - 管理不同平台的特定配置

### 1.2 运营支持模块
- **使用统计分析** - 用户行为和功能使用统计
- **API调用监控** - AI API调用监控和成本分析
- **错误日志管理** - 系统错误追踪和诊断
- **版本发布管理** - 配置版本控制和灰度发布

## 2. 详细功能需求

### 2.1 AI模型配置管理

#### 2.1.1 AI服务提供商管理
**功能描述**: 管理不同的AI服务提供商配置

**数据字段**:
- 提供商名称 (DeepSeek, OpenAI, Claude, 通义千问等)
- API基础URL
- 认证方式 (API Key, OAuth等)
- 支持的模型列表
- 状态 (启用/禁用)
- 创建时间/更新时间

**操作功能**:
- ✅ 添加新的AI服务提供商
- ✅ 编辑提供商信息
- ✅ 启用/禁用提供商
- ✅ 测试API连接
- ✅ 查看提供商使用统计

#### 2.1.2 AI模型配置
**功能描述**: 配置具体的AI模型参数

**数据字段**:
- 模型名称 (deepseek-chat, gpt-4, claude-3等)
- 所属提供商
- API密钥 (加密存储)
- 模型参数:
  - temperature (0.0-2.0)
  - max_tokens (1-4000)
  - top_p (0.0-1.0)
  - frequency_penalty (-2.0-2.0)
  - presence_penalty (-2.0-2.0)
- 角色设定 (主模型/备用模型)
- 优先级
- 成本配置 (每1K tokens成本)

**操作功能**:
- ✅ 添加/编辑模型配置
- ✅ 设置主备模型
- ✅ 参数调优和测试
- ✅ 模型性能监控
- ✅ 成本预算管理

### 2.2 提示词模板管理

#### 2.2.1 系统提示词管理
**功能描述**: 管理AI的角色设定和行为规范

**数据字段**:
- 模板名称
- 模板类型 (系统提示词/用户提示词)
- 提示词内容
- 适用场景 (占卜解读/卦象分析/建议生成)
- 版本号
- 状态 (草稿/生效/已废弃)

**操作功能**:
- ✅ 创建/编辑提示词模板
- ✅ 版本管理和回滚
- ✅ A/B测试支持
- ✅ 效果评估和优化建议
- ✅ 模板预览和测试

#### 2.2.2 解读格式模板
**功能描述**: 管理AI输出的格式规范

**数据字段**:
- 格式名称
- 输出结构定义
- 标题格式规范
- 内容组织方式
- 特殊标记说明

**操作功能**:
- ✅ 定义输出格式
- ✅ 格式验证和测试
- ✅ 格式效果预览

### 2.3 应用配置管理

#### 2.3.1 主题和UI配置
**功能描述**: 管理应用的视觉主题和UI设置

**数据字段**:
- 主题名称 (chinese, light, dark)
- 颜色配置:
  - 主色调
  - 五行颜色 (木火土金水)
  - 文本颜色
  - 背景颜色
- 字体配置:
  - 字体族
  - 字体大小范围
  - 行高设置
- 布局配置:
  - 组件间距
  - 圆角大小
  - 阴影效果

**操作功能**:
- ✅ 主题编辑器
- ✅ 颜色选择器
- ✅ 实时预览
- ✅ 主题导入/导出

#### 2.3.2 功能开关管理
**功能描述**: 控制应用功能的启用/禁用

**数据字段**:
- 功能名称
- 功能描述
- 开关状态
- 适用平台
- 生效时间
- 用户群体 (全部用户/测试用户/VIP用户)

**操作功能**:
- ✅ 功能开关控制
- ✅ 灰度发布管理
- ✅ 用户群体定向
- ✅ 定时生效设置

### 2.4 内容数据管理

#### 2.4.1 卦象数据管理
**功能描述**: 管理六壬金口诀的卦象基础数据

**数据字段**:
- 卦象名称 (大安、留连、速喜、赤口、小吉、空亡)
- 五行属性
- 卦象描述
- 解释文本
- 宜忌建议
- 时间方位信息
- 化解方法

**操作功能**:
- ✅ 卦象信息编辑
- ✅ 批量导入/导出
- ✅ 内容版本管理
- ✅ 多语言支持

#### 2.4.2 五行关系配置
**功能描述**: 管理五行相生相克关系

**数据字段**:
- 五行元素 (木火土金水)
- 相生关系
- 相克关系
- 关系强度
- 影响描述

**操作功能**:
- ✅ 关系图编辑
- ✅ 关系验证
- ✅ 可视化展示

### 2.5 平台配置管理

#### 2.5.1 微信小程序配置
**功能描述**: 管理微信小程序特定配置

**数据字段**:
- 域名白名单
- 内容审核规则
- 功能限制配置
- 分享配置
- 支付配置

**操作功能**:
- ✅ 域名管理
- ✅ 审核规则配置
- ✅ 功能适配设置

#### 2.5.2 iOS/Android配置
**功能描述**: 管理原生应用特定配置

**数据字段**:
- 应用版本信息
- 更新策略
- 权限配置
- 推送配置
- 分析配置

**操作功能**:
- ✅ 版本管理
- ✅ 更新策略设置
- ✅ 权限配置管理

## 3. 运营支持功能

### 3.1 使用统计分析

#### 3.1.1 用户行为统计
- 占卜次数统计
- 功能使用频率
- 用户留存分析
- 平台分布统计

#### 3.1.2 内容效果分析
- AI解读质量评估
- 用户满意度统计
- 错误率分析
- 响应时间监控

### 3.2 API调用监控

#### 3.2.1 调用量统计
- 每日/每月调用量
- 成本统计和预算控制
- 提供商使用分布
- 异常调用监控

#### 3.2.2 性能监控
- 响应时间统计
- 成功率监控
- 错误类型分析
- 服务可用性监控

### 3.3 系统管理

#### 3.3.1 用户权限管理
- 管理员账户管理
- 角色权限配置
- 操作日志记录
- 安全审计

#### 3.3.2 系统配置
- 数据库配置
- 缓存配置
- 日志配置
- 备份策略

## 4. 界面设计要求

### 4.1 整体风格
- 简洁现代的管理界面
- 响应式设计，支持桌面和平板
- 符合Material Design规范
- 支持暗色主题

### 4.2 关键页面
1. **仪表板** - 关键指标概览
2. **AI配置** - 模型和提示词管理
3. **应用配置** - 主题和功能设置
4. **内容管理** - 卦象和文本数据
5. **统计分析** - 使用数据和性能监控
6. **系统设置** - 用户和权限管理

### 4.3 交互要求
- 实时数据更新
- 批量操作支持
- 拖拽排序
- 快速搜索和筛选
- 操作确认和撤销

## 5. 技术要求

### 5.1 性能要求
- 页面加载时间 < 2秒
- API响应时间 < 500ms
- 支持并发用户数 > 100
- 数据实时性 < 5秒

### 5.2 安全要求
- HTTPS加密传输
- API密钥加密存储
- 操作权限验证
- 审计日志记录

### 5.3 兼容性要求
- 支持Chrome 90+, Firefox 88+, Safari 14+
- 支持移动端浏览器
- 支持1920x1080及以上分辨率

## 6. 验收标准

### 6.1 功能验收
- ✅ 所有CRUD操作正常
- ✅ 数据验证和错误处理
- ✅ 权限控制有效
- ✅ 实时数据同步

### 6.2 性能验收
- ✅ 满足性能要求指标
- ✅ 压力测试通过
- ✅ 内存使用合理

### 6.3 安全验收
- ✅ 安全扫描通过
- ✅ 权限测试通过
- ✅ 数据加密验证
